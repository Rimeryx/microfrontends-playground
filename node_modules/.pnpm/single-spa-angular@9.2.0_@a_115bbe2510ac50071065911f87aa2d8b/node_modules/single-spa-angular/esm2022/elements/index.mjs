import { getContainerElementAndSetTemplate, } from 'single-spa-angular/internals';
const defaultOptions = {
    element: null,
    template: null,
    ngModuleRefOrAppRef: null,
    bootstrapFunction: null,
    domElementGetter: undefined,
};
async function bootstrap(options, props) {
    if (options.ngModuleRefOrAppRef !== null) {
        return;
    }
    // We call `bootstrapFunction()` inside the bootstrap lifecycle hook
    // because Angular modules that expose custom elements should be
    // bootstrapped only once.
    options.ngModuleRefOrAppRef = await options.bootstrapFunction(props);
}
async function mount(options, props) {
    const containerElement = getContainerElementAndSetTemplate(options, props);
    // `options.template` which can be `<app-element />` is not a valid selector
    // for `document.querySelector`, thus we retrieve this custom element
    // via this property.
    options.element = containerElement.firstElementChild;
}
function unmount(options) {
    return Promise.resolve().then(() => {
        // Removing custom element from DOM is enough since it will trigger
        // `disconnectedCallback()` and Angular will dispose all resources.
        options.element.parentElement.removeChild(options.element);
        options.element = null;
    });
}
export function singleSpaAngularElements(userOptions) {
    const options = {
        ...defaultOptions,
        ...userOptions,
    };
    return {
        bootstrap: bootstrap.bind(null, options),
        mount: mount.bind(null, options),
        unmount: unmount.bind(null, options),
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9saWJzL3NpbmdsZS1zcGEtYW5ndWxhci9lbGVtZW50cy9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUVMLGlDQUFpQyxHQUNsQyxNQUFNLDhCQUE4QixDQUFDO0FBSXRDLE1BQU0sY0FBYyxHQUFnRDtJQUNsRSxPQUFPLEVBQUUsSUFBSTtJQUNiLFFBQVEsRUFBRSxJQUFLO0lBQ2YsbUJBQW1CLEVBQUUsSUFBSTtJQUN6QixpQkFBaUIsRUFBRSxJQUFLO0lBQ3hCLGdCQUFnQixFQUFFLFNBQVM7Q0FDNUIsQ0FBQztBQUVGLEtBQUssVUFBVSxTQUFTLENBQUMsT0FBb0QsRUFBRSxLQUFVO0lBQ3ZGLElBQUksT0FBTyxDQUFDLG1CQUFtQixLQUFLLElBQUksRUFBRSxDQUFDO1FBQ3pDLE9BQU87SUFDVCxDQUFDO0lBRUQsb0VBQW9FO0lBQ3BFLGdFQUFnRTtJQUNoRSwwQkFBMEI7SUFDMUIsT0FBTyxDQUFDLG1CQUFtQixHQUFHLE1BQU0sT0FBTyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3ZFLENBQUM7QUFFRCxLQUFLLFVBQVUsS0FBSyxDQUFDLE9BQW9ELEVBQUUsS0FBVTtJQUNuRixNQUFNLGdCQUFnQixHQUFHLGlDQUFpQyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztJQUMzRSw0RUFBNEU7SUFDNUUscUVBQXFFO0lBQ3JFLHFCQUFxQjtJQUNyQixPQUFPLENBQUMsT0FBTyxHQUFHLGdCQUFnQixDQUFDLGlCQUE4QixDQUFDO0FBQ3BFLENBQUM7QUFFRCxTQUFTLE9BQU8sQ0FBQyxPQUFvRDtJQUNuRSxPQUFPLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO1FBQ2pDLG1FQUFtRTtRQUNuRSxtRUFBbUU7UUFDbkUsT0FBTyxDQUFDLE9BQVEsQ0FBQyxhQUFjLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxPQUFRLENBQUMsQ0FBQztRQUM5RCxPQUFPLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztJQUN6QixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRCxNQUFNLFVBQVUsd0JBQXdCLENBQUMsV0FBd0M7SUFDL0UsTUFBTSxPQUFPLEdBQWdEO1FBQzNELEdBQUcsY0FBYztRQUNqQixHQUFHLFdBQVc7S0FDZixDQUFDO0lBRUYsT0FBTztRQUNMLFNBQVMsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUM7UUFDeEMsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQztRQUNoQyxPQUFPLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDO0tBQ3JDLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBMaWZlQ3ljbGVzIH0gZnJvbSAnc2luZ2xlLXNwYSc7XG5pbXBvcnQgdHlwZSB7IE5nRWxlbWVudCB9IGZyb20gJ0Bhbmd1bGFyL2VsZW1lbnRzJztcbmltcG9ydCB7XG4gIEJhc2VTaW5nbGVTcGFBbmd1bGFyT3B0aW9ucyxcbiAgZ2V0Q29udGFpbmVyRWxlbWVudEFuZFNldFRlbXBsYXRlLFxufSBmcm9tICdzaW5nbGUtc3BhLWFuZ3VsYXIvaW50ZXJuYWxzJztcblxuaW1wb3J0IHsgQm9vdHN0cmFwcGVkU2luZ2xlU3BhQW5ndWxhckVsZW1lbnRzT3B0aW9ucyB9IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBkZWZhdWx0T3B0aW9uczogQm9vdHN0cmFwcGVkU2luZ2xlU3BhQW5ndWxhckVsZW1lbnRzT3B0aW9ucyA9IHtcbiAgZWxlbWVudDogbnVsbCxcbiAgdGVtcGxhdGU6IG51bGwhLFxuICBuZ01vZHVsZVJlZk9yQXBwUmVmOiBudWxsLFxuICBib290c3RyYXBGdW5jdGlvbjogbnVsbCEsXG4gIGRvbUVsZW1lbnRHZXR0ZXI6IHVuZGVmaW5lZCxcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIGJvb3RzdHJhcChvcHRpb25zOiBCb290c3RyYXBwZWRTaW5nbGVTcGFBbmd1bGFyRWxlbWVudHNPcHRpb25zLCBwcm9wczogYW55KSB7XG4gIGlmIChvcHRpb25zLm5nTW9kdWxlUmVmT3JBcHBSZWYgIT09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBXZSBjYWxsIGBib290c3RyYXBGdW5jdGlvbigpYCBpbnNpZGUgdGhlIGJvb3RzdHJhcCBsaWZlY3ljbGUgaG9va1xuICAvLyBiZWNhdXNlIEFuZ3VsYXIgbW9kdWxlcyB0aGF0IGV4cG9zZSBjdXN0b20gZWxlbWVudHMgc2hvdWxkIGJlXG4gIC8vIGJvb3RzdHJhcHBlZCBvbmx5IG9uY2UuXG4gIG9wdGlvbnMubmdNb2R1bGVSZWZPckFwcFJlZiA9IGF3YWl0IG9wdGlvbnMuYm9vdHN0cmFwRnVuY3Rpb24ocHJvcHMpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBtb3VudChvcHRpb25zOiBCb290c3RyYXBwZWRTaW5nbGVTcGFBbmd1bGFyRWxlbWVudHNPcHRpb25zLCBwcm9wczogYW55KSB7XG4gIGNvbnN0IGNvbnRhaW5lckVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50QW5kU2V0VGVtcGxhdGUob3B0aW9ucywgcHJvcHMpO1xuICAvLyBgb3B0aW9ucy50ZW1wbGF0ZWAgd2hpY2ggY2FuIGJlIGA8YXBwLWVsZW1lbnQgLz5gIGlzIG5vdCBhIHZhbGlkIHNlbGVjdG9yXG4gIC8vIGZvciBgZG9jdW1lbnQucXVlcnlTZWxlY3RvcmAsIHRodXMgd2UgcmV0cmlldmUgdGhpcyBjdXN0b20gZWxlbWVudFxuICAvLyB2aWEgdGhpcyBwcm9wZXJ0eS5cbiAgb3B0aW9ucy5lbGVtZW50ID0gY29udGFpbmVyRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCBhcyBOZ0VsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIHVubW91bnQob3B0aW9uczogQm9vdHN0cmFwcGVkU2luZ2xlU3BhQW5ndWxhckVsZW1lbnRzT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgLy8gUmVtb3ZpbmcgY3VzdG9tIGVsZW1lbnQgZnJvbSBET00gaXMgZW5vdWdoIHNpbmNlIGl0IHdpbGwgdHJpZ2dlclxuICAgIC8vIGBkaXNjb25uZWN0ZWRDYWxsYmFjaygpYCBhbmQgQW5ndWxhciB3aWxsIGRpc3Bvc2UgYWxsIHJlc291cmNlcy5cbiAgICBvcHRpb25zLmVsZW1lbnQhLnBhcmVudEVsZW1lbnQhLnJlbW92ZUNoaWxkKG9wdGlvbnMuZWxlbWVudCEpO1xuICAgIG9wdGlvbnMuZWxlbWVudCA9IG51bGw7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2luZ2xlU3BhQW5ndWxhckVsZW1lbnRzKHVzZXJPcHRpb25zOiBCYXNlU2luZ2xlU3BhQW5ndWxhck9wdGlvbnMpOiBMaWZlQ3ljbGVzIHtcbiAgY29uc3Qgb3B0aW9uczogQm9vdHN0cmFwcGVkU2luZ2xlU3BhQW5ndWxhckVsZW1lbnRzT3B0aW9ucyA9IHtcbiAgICAuLi5kZWZhdWx0T3B0aW9ucyxcbiAgICAuLi51c2VyT3B0aW9ucyxcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGJvb3RzdHJhcDogYm9vdHN0cmFwLmJpbmQobnVsbCwgb3B0aW9ucyksXG4gICAgbW91bnQ6IG1vdW50LmJpbmQobnVsbCwgb3B0aW9ucyksXG4gICAgdW5tb3VudDogdW5tb3VudC5iaW5kKG51bGwsIG9wdGlvbnMpLFxuICB9O1xufVxuIl19