/* single-spa@7.0.0-beta.13 - ESM - prod */
let t=[];function n(n,e,o){const r=i(n,e,o);t.length?t.forEach((t=>t(r))):setTimeout((()=>{throw r}))}function e(n){if("function"!=typeof n)throw Error(r(28));t.push(n)}function o(n){if("function"!=typeof n)throw Error(r(29));let e=!1;return t=t.filter((t=>{const o=t===n;return e=e||o,!o})),e}function r(t,n,...e){return`single-spa minified message #${t}: See https://single-spa.js.org/error/?code=${t}${e.length?`&arg=${e.join("&arg=")}`:""}`}function i(t,n,e){const o=`${f(n)} '${c(n)}' died in status ${n.status}: `;let i;if(t instanceof Error){try{t.message=o+t.message}catch(t){}i=t}else{console.warn(r(30,0,n.status,c(n)));try{i=Error(o+JSON.stringify(t))}catch(n){i=t}}const s=i;return s.appOrParcelName=c(n),n.status=e,s}var s;function u(t){return t.status===s.MOUNTED}function a(t){try{return t.activeWhen(window.location)}catch(e){return n(e,t,s.SKIP_BECAUSE_BROKEN),!1}}function c(t){return t.name}function l(t){return Boolean(t.unmountThisParcel)}function f(t){return l(t)?"parcel":"application"}function h(t){return t&&("function"==typeof t||(n=t,Array.isArray(n)&&!n.find((t=>"function"!=typeof t))));var n}function p(t,n,e){let o=Array.isArray(t[n])?t[n]:[t[n]].filter(Boolean);0===o.length&&(o=[()=>Promise.resolve()]);const i=e?"parcel":"application",s=c(t);return function(t){return o.reduce(((e,o,u)=>e.then((()=>{const e=o(t);return m(e)?e:Promise.reject(r(15,0,i,s,n,u))}))),Promise.resolve())}}function m(t){return t&&"function"==typeof t.then&&"function"==typeof t.catch}!function(t){t.NOT_LOADED="NOT_LOADED",t.LOADING_SOURCE_CODE="LOADING_SOURCE_CODE",t.NOT_INITIALIZED="NOT_INITIALIZED",t.INITIALIZING="INITIALIZING",t.NOT_MOUNTED="NOT_MOUNTED",t.MOUNTING="MOUNTING",t.MOUNTED="MOUNTED",t.UPDATING="UPDATING",t.UNMOUNTING="UNMOUNTING",t.UNLOADING="UNLOADING",t.LOAD_ERROR="LOAD_ERROR",t.SKIP_BECAUSE_BROKEN="SKIP_BECAUSE_BROKEN"}(s||(s={}));let E=[];function w(t,e){return Promise.resolve().then((()=>t.status!==s.NOT_INITIALIZED?t:(t.status=s.INITIALIZING,B(t,"init").then(o).catch((o=>{if(e)throw i(o,t,s.SKIP_BECAUSE_BROKEN);return n(o,t,s.SKIP_BECAUSE_BROKEN),t})))));function o(){return t.status=s.NOT_MOUNTED,t}}function d(t,e){return Promise.resolve().then((()=>{if(t.status!==s.MOUNTED)return t;t.status=s.UNMOUNTING;const o=Object.keys(t.parcels).map((n=>t.parcels[n].unmountThisParcel()));return Promise.all(o).then(r,(o=>r().then((()=>{const r=Error(o.message);if(e)throw i(r,t,s.SKIP_BECAUSE_BROKEN);n(r,t,s.SKIP_BECAUSE_BROKEN)})))).then((()=>t));function r(){return B(t,"unmount").then((()=>{t.status=s.NOT_MOUNTED}),(o=>{if(e)throw i(o,t,s.SKIP_BECAUSE_BROKEN);n(o,t,s.SKIP_BECAUSE_BROKEN)}))}}))}let O=!1,N=!1;function T(t,e){return Promise.resolve().then((()=>t.status!==s.NOT_MOUNTED?t:(O||(window.dispatchEvent(new CustomEvent("single-spa:before-first-mount")),O=!0),t.status=s.MOUNTING,B(t,"mount").then((()=>(t.status=s.MOUNTED,N||(window.dispatchEvent(new CustomEvent("single-spa:first-mount")),N=!0),t))).catch((o=>{return t.status=s.MOUNTED,d(t,!0).then(r,r);function r(){if(e)throw i(o,t,s.SKIP_BECAUSE_BROKEN);return n(o,t,s.SKIP_BECAUSE_BROKEN),t}})))))}let v=0;const y={name:"rootParcels",parcels:{}};function _(t,n){return g.call(y,t,n)}function g(t,n){const e=this;if(!t||"object"!=typeof t&&"function"!=typeof t)throw Error(r(2));if(t.name&&"string"!=typeof t.name)throw Error(r(3,0,typeof t.name));const o=v++;let u=t.name||`parcel-${o}`;if("object"!=typeof n)throw Error(r(4,0,u,typeof n));if(!n.domElement)throw Error(r(5,0,u));const a="function"==typeof t,l=a?t:()=>Promise.resolve(t),f={id:o,parcels:{},status:a?s.LOADING_SOURCE_CODE:s.NOT_INITIALIZED,customProps:n,parentName:c(e),currentTask:void 0,unmountThisParcel:()=>f.currentTask.then((()=>{if(f.status!==s.MOUNTED)throw Error(r(6,0,u,f.status));return d(f,!0).then((t=>(f.parentName&&delete e.parcels[f.id],t))).then((t=>(N(t),t))).catch((t=>{throw f.status=s.SKIP_BECAUSE_BROKEN,y(t),t}))}))};let m=l();if(!m||"function"!=typeof m.then)throw Error(r(7));m=m.then((t=>{if(!t)throw Error(r(8));if(u=t.name||`parcel-${o}`,Object.prototype.hasOwnProperty.call(t,"init")&&!h(t.init))throw Error(r(9,0,u));if(!h(t.mount))throw Error(r(10,0,u));if(!h(t.unmount))throw Error(r(11,0,u));if(t.update&&!h(t.update))throw Error(r(12,0,u));const n=p(t,t.init?"init":"bootstrap",!0),i=p(t,"mount",!0),a=p(t,"unmount",!0);f.status=s.NOT_INITIALIZED,f.name=u,f.init=n,f.mount=i,f.unmount=a,f.timeouts=M(t.timeouts),t.update&&(f.update=p(t,"update",!0));const c=f;return e.parcels[o]=c,t}));const E=m.then((()=>w(f,!0))),O=E.then((()=>f.currentTask=T(f,!0)));let N,y;f.currentTask=O;const _=new Promise(((t,n)=>{N=t,y=n}));let g={mount:()=>P(Promise.resolve().then((()=>{if(f.status!==s.NOT_MOUNTED)throw Error(r(13,0,u,f.status));return e.parcels[o]=f,T(f)}))),unmount:()=>P(f.unmountThisParcel()),getStatus:()=>f.status,loadPromise:P(m),initPromise:P(E),mountPromise:P(O),unmountPromise:P(_),_parcel:f};return m.then((t=>{t.update&&(g.update=function(t){return f.currentTask=f.currentTask.then((()=>{return f.customProps=t,P((n=f,Promise.resolve().then((()=>{if(n.status!==s.MOUNTED)throw Error(r(32,0,c(n)));return n.status=s.UPDATING,B(n,"update").then((()=>(n.status=s.MOUNTED,n))).catch((t=>{throw i(t,n,s.SKIP_BECAUSE_BROKEN)}))}))));var n}))})}),(()=>{})),g}function P(t){return t.then((()=>null))}function A(t){const n=c(t);let e="function"==typeof t.customProps?t.customProps(n,window.location):t.customProps;("object"!=typeof e||null===e||Array.isArray(e))&&(e={},console.warn(r(40),n,e));const o=Object.assign({},e,{name:n,mountParcel:g.bind(t)});return l(t)&&(o.unmountSelf=t.unmountThisParcel),o}const D=1e3,I={init:{millis:4e3,dieOnTimeout:!1,warningMillis:D},mount:{millis:3e3,dieOnTimeout:!1,warningMillis:D},unmount:{millis:3e3,dieOnTimeout:!1,warningMillis:D},unload:{millis:3e3,dieOnTimeout:!1,warningMillis:D},update:{millis:3e3,dieOnTimeout:!1,warningMillis:D}};function U(t,n,e){if("number"!=typeof t||t<=0)throw Error(r(16));I.init={millis:t,dieOnTimeout:n,warningMillis:e||D}}function S(t,n,e){if("number"!=typeof t||t<=0)throw Error(r(17));I.mount={millis:t,dieOnTimeout:n,warningMillis:e||D}}function L(t,n,e){if("number"!=typeof t||t<=0)throw Error(r(18));I.unmount={millis:t,dieOnTimeout:n,warningMillis:e||D}}function R(t,n,e){if("number"!=typeof t||t<=0)throw Error(r(19));I.unload={millis:t,dieOnTimeout:n,warningMillis:e||D}}function B(t,n){const e=t.timeouts[n],o=e.warningMillis,i=f(t);return new Promise(((s,u)=>{let a=!1,l=!1;t[n](A(t)).then((t=>{a=!0,s(t)})).catch((t=>{a=!0,u(t)})),setTimeout((()=>h(1)),o),setTimeout((()=>h(!0)),e.millis);const f=r(31,0,n,i,c(t),e.millis);function h(t){if(!a)if(!0===t)l=!0,e.dieOnTimeout?u(Error(f)):console.error(f);else if(!l){const n=t,r=n*o;console.warn(f),r+o<e.millis&&setTimeout((()=>h(n+1)),o)}}}))}function M(t){var n;const e={};for(let o in I)e[o]=Object.assign({},I[o],null!==(n=null==t?void 0:t[o])&&void 0!==n?n:{});return e}function K(t){return Promise.resolve().then((()=>{if(t.loadPromise)return t.loadPromise;if(t.status!==s.NOT_LOADED&&t.status!==s.LOAD_ERROR)return t;const e=t;let o,i;return e.status=s.LOADING_SOURCE_CODE,e.loadPromise=Promise.resolve().then((()=>{const u=e.loadApp(A(t));if(!m(u))throw i=!0,Error(r(33,0,c(e)));return u.then((i=>{let u;if(e.loadErrorTime=null,o=i,"object"!=typeof o&&(u=34),h(o.mount)||(u=36),h(o.unmount)||(u=37),u){let t;try{t=JSON.stringify(o)}catch(t){}return console.error(r(u,0,"application",c(e),t),o),n(void 0,e,s.SKIP_BECAUSE_BROKEN),e}return o.devtools&&o.devtools.overlays&&(e.devtools.overlays=Object.assign({},t.devtools.overlays,o.devtools.overlays)),e.status=s.NOT_INITIALIZED,e.init=p(o,"init",!1),e.mount=p(o,"mount",!1),e.unmount=p(o,"unmount",!1),e.unload=p(o,"unload",!1),e.timeouts=M(o.timeouts),delete e.loadPromise,e}))})).catch((t=>{let o;return delete e.loadPromise,i?o=s.SKIP_BECAUSE_BROKEN:(o=s.LOAD_ERROR,e.loadErrorTime=(new Date).getTime()),n(t,e,o),e}))}))}const C="undefined"!=typeof window,b={hashchange:[],popstate:[]},j=["hashchange","popstate"];function G(t){let n;if("string"==typeof t)n=t;else if(this&&this.href)n=this.href;else{if(!(t&&"currentTarget"in t&&"href"in t.currentTarget&&"preventDefault"in t))throw Error(r(14));n=t.currentTarget.href,t.preventDefault()}const e=new URL(window.location.href),o=new URL(n,window.location.href);0===n.indexOf("#")?window.location.hash=o.hash:e.host!==o.host&&o.host?window.location.href=n:o.pathname===e.pathname&&o.search===e.search?window.location.hash=o.hash:window.history.pushState(null,null,n)}function $(t){if(t){const n=t[0].type;j.indexOf(n)>=0&&b[n].forEach((n=>{try{n.apply(this,t)}catch(t){setTimeout((()=>{throw t}))}}))}}let k;function W(t){Nt([],[t])}function x(t,n){return function(){const e=window.location.href,o=t.apply(this,arguments),r=window.location.href;return k&&e===r||window.dispatchEvent(function(t,n){let e=new PopStateEvent("popstate",{state:t});return e.singleSpa=!0,e.singleSpaTrigger=n,e}(window.history.state,n)),o}}let Z=null,F=!1;function J(t){if(F)throw Error(r(43));k=!(null==t?void 0:t.hasOwnProperty("urlRerouteOnly"))||t.urlRerouteOnly,F=!0,Z=window.history.replaceState,window.addEventListener("hashchange",W),window.addEventListener("popstate",W);const n=window.addEventListener,e=window.removeEventListener;window.addEventListener=function(t,e){if(!("function"==typeof e&&j.indexOf(t)>=0)||b[t].find((t=>t===e)))return n.apply(this,arguments);b[t].push(e)},window.removeEventListener=function(t,n){return"function"==typeof n&&j.includes(t)&&(b[t]=b[t].filter((t=>t!==n))),e.apply(this,arguments)},window.history.pushState=x(window.history.pushState,"pushState"),window.history.replaceState=x(Z,"replaceState")}C&&(window.singleSpaNavigate?console.warn(r(41)):window.singleSpaNavigate=G);let V=!1;function q(t=window.jQuery){var n,e;if(!t&&(null===(e=null===(n=null===window||void 0===window?void 0:window.$)||void 0===n?void 0:n.fn)||void 0===e?void 0:e.jquery)&&(t=window.$),t&&!V){const n=t.fn.on,e=t.fn.off;t.fn.on=function(t,e){return Q.call(this,n,window.addEventListener,t,e,arguments)},t.fn.off=function(t,n){return Q.call(this,e,window.removeEventListener,t,n,arguments)},V=!0}}function Q(t,n,e,o,r){return"string"!=typeof e?t.apply(this,r):(e.split(/\s+/).forEach((t=>{j.indexOf(t)>=0&&(n(t,o),e=e.replace(t,""))})),""===e.trim()?this:t.apply(this,r))}const z={};function H(t){return Promise.resolve().then((()=>{const e=z[c(t)];if(!e)return t;if(t.status===s.NOT_LOADED)return X(t,e),t;if(t.status===s.UNLOADING)return e.promise.then((()=>t));if(t.status!==s.NOT_MOUNTED&&t.status!==s.LOAD_ERROR&&t.status!==s.SKIP_BECAUSE_BROKEN)return t;const o=t.unload?B(t,"unload"):Promise.resolve();return t.status=s.UNLOADING,o.then((()=>(X(t,e),t))).catch((o=>(function(t,e,o){delete z[c(t)],delete t.init,delete t.mount,delete t.unmount,delete t.unload,n(o,t,s.SKIP_BECAUSE_BROKEN),e.reject(o)}(t,e,o),t)))}))}function X(t,n){delete z[c(t)],delete t.init,delete t.mount,delete t.unmount,delete t.unload,t.status=s.NOT_LOADED,n.resolve()}function Y(t,n,e,o){z[c(t)]={app:t,resolve:e,reject:o},Object.defineProperty(z[c(t)],"promise",{get:n})}function tt(t){return z[t]}const nt=[];function et(){return nt.filter(u).map(c)}function ot(){return nt.map(c)}function rt(t){const n=nt.find((n=>c(n)===t));return n?n.status:null}let it=!1;function st(t,n,e,o){const i=function(t,n,e,o){let i;return"object"==typeof t?(function(t){if(Array.isArray(t)||null===t)throw Error(r(39));const n=["name","app","activeWhen","customProps"],e=Object.keys(t).reduce(((t,e)=>n.indexOf(e)>=0?t:t.concat(e)),[]);if(0!==e.length)throw Error(r(38,0,n.join(", "),e.join(", ")));if("string"!=typeof t.name||0===t.name.length)throw Error(r(20));if("object"!=typeof t.app&&"function"!=typeof t.app)throw Error(r(20));const o=t=>"string"==typeof t||"function"==typeof t;if(!(o(t.activeWhen)||Array.isArray(t.activeWhen)&&t.activeWhen.every(o)))throw Error(r(24));if(!ft(t.customProps))throw Error(r(22))}(t),i={name:t.name,app:t.app,activeWhen:t.activeWhen,customProps:t.customProps}):(function(t,n,e,o){if("string"!=typeof t||0===t.length)throw Error(r(20));if(!n)throw Error(r(23));if("function"!=typeof e)throw Error(r(24));if(!ft(o))throw Error(r(22))}(t,n,e,o),i={name:t,app:n,activeWhen:e,customProps:o}),{name:i.name,loadApp:(s=i.app,"function"!=typeof s?()=>Promise.resolve(s):s),customProps:ht(i.customProps),activeWhen:pt(i.activeWhen)};var s}(t,n,e,o);if(_t()||it||(it=!0,setTimeout((()=>{_t()||console.warn(r(1))}),5e3)),-1!==ot().indexOf(i.name))throw Error(r(21,0,i.name));nt.push(Object.assign({loadErrorTime:null,status:s.NOT_LOADED,parcels:{},devtools:{overlays:{options:{},selectors:[]}}},i)),C&&(q(),Nt())}function ut(t=window.location){return nt.filter((n=>n.activeWhen(t))).map(c)}function at(t){if(0===nt.filter((n=>c(n)===t)).length)throw Error(r(25,0,t));return(C?ct(t,{waitForUnmount:!1}):Promise.resolve()).then((()=>{const n=nt.map(c).indexOf(t);nt.splice(n,1)}))}function ct(t,n={waitForUnmount:!1}){if("string"!=typeof t)throw Error(r(26));const e=nt.find((n=>c(n)===t));if(!e)throw Error(r(27,0,t));const o=tt(c(e));if(null==n?void 0:n.waitForUnmount){if(o)return o.promise;{const t=new Promise(((n,o)=>{Y(e,(()=>t),n,o)}));return t}}{let t;return o?(t=o.promise,lt(e,o.resolve,o.reject)):t=new Promise(((n,o)=>{Y(e,(()=>t),n,o),lt(e,n,o)})),t}}function lt(t,n,e){Promise.resolve().then((()=>{if(ut().find((n=>n===c(t))))return Ot()})).then((()=>d(t).then(H).then((()=>{n(),setTimeout((()=>{Nt()}))})))).catch(e)}function ft(t){return!t||"function"==typeof t||"object"==typeof t&&null!==t&&!Array.isArray(t)}function ht(t){return t||{}}function pt(t){const n=(Array.isArray(t)?t:[t]).map((t=>"function"==typeof t?t:mt(t,!1)));return t=>n.some((n=>n(t)))}function mt(t,n){const e=function(t,n){let e=0,o=!1,r="^";"/"!==t[0]&&(t="/"+t);for(let n=0;n<t.length;n++){const e=t[n];(!o&&":"===e||o&&"/"===e)&&i(n)}return i(t.length),new RegExp(r,"i");function i(i){const s=t.slice(e,i).replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");if(r+=o?"[^/]+/?":s,i===t.length)if(o)n&&(r+="$");else{const t=n?"":".*";r="/"===r.charAt(r.length-1)?`${r}${t}$`:`${r}(/${t})?(#.*)?$`}o=!o,e=i}}(t,n);return t=>{const n=t.href.replace(t.origin,"").replace(t.search,"").split("?")[0];return e.test(n)}}let Et=!1,wt=[],dt=C&&window.location.href;function Ot(){return Nt()}function Nt(t=[],n=void 0,e=!1){if(Et)return new Promise(((t,e)=>{wt.push({resolve:t,reject:e,eventArguments:n})}));const{appsToUnload:o,appsToUnmount:i,appsToLoad:u,appsToMount:l}=function(){const t=[],n=[],e=[],o=[],r=(new Date).getTime();return nt.forEach((i=>{const u=i.status!==s.SKIP_BECAUSE_BROKEN&&a(i);switch(i.status){case s.LOAD_ERROR:u&&r-i.loadErrorTime>=200&&e.push(i);break;case s.NOT_LOADED:case s.LOADING_SOURCE_CODE:u&&e.push(i);break;case s.NOT_INITIALIZED:case s.NOT_MOUNTED:!u&&tt(c(i))?t.push(i):u&&o.push(i);break;case s.MOUNTED:u||n.push(i)}})),{appsToUnload:t,appsToUnmount:n,appsToLoad:e,appsToMount:o}}();let f,h=[],p=dt,m=dt=window.location.href;return _t()?(Et=!0,f=o.concat(u,i,l),Promise.resolve().then((()=>(T(0===f.length?"before-no-app-change":"before-app-change",N(!0)),T("before-routing-event",N(!0,{cancelNavigation:E})),Promise.all(h).then((e=>{if(e.some((t=>t)))return Z.call(window.history,history.state,"",p.substring(location.origin.length)),dt=location.href,Et=!1,Nt(t,n,!0);const r=o.map(H),s=[...i.map((t=>d(t))).map((t=>t.then(H))),...r],a=Promise.all(s);a.then((()=>{T("before-mount-routing-event",N(!0))}),(t=>{throw t}));const c=u.map((t=>K(t).then((t=>Tt(t,a))))),f=l.filter((t=>!u.includes(t))).map((t=>Tt(t,a)));return a.catch((t=>{throw O(),t})).then((()=>(O(),Promise.all(c.concat(f)).catch((n=>{throw t.forEach((t=>t.reject(n))),n})).then((()=>{}),(t=>{throw t})).then(w))))})))))):(f=u,Promise.resolve().then((()=>{const t=u.map(K);return Promise.all(t).then(O).then((()=>[])).catch((t=>{throw O(),t})).finally((()=>{}))})));function E(t=!0){const n="function"==typeof(null==t?void 0:t.then)?t:Promise.resolve(t);h.push(n.catch((t=>(console.warn(Error(r(42))),console.warn(t),!1))))}function w(){const n=et();t.forEach((t=>t.resolve(n)));try{T(0===f.length?"no-app-change":"app-change",N()),T("routing-event",N())}catch(t){setTimeout((()=>{throw t}))}if(Et=!1,wt.length>0){const t=wt;wt=[],Nt(t)}return n}function O(){e||(t.forEach((t=>{$(t.eventArguments)})),$(n))}function N(t=!1,e){const r={},a={[s.MOUNTED]:[],[s.NOT_MOUNTED]:[],[s.NOT_LOADED]:[],[s.SKIP_BECAUSE_BROKEN]:[]};t?(u.concat(l).forEach(((t,n)=>{E(t,s.MOUNTED)})),o.forEach((t=>{E(t,s.NOT_LOADED)})),i.forEach((t=>{E(t,s.NOT_MOUNTED)}))):f.forEach((t=>{E(t)}));const h={detail:{newAppStatuses:r,appsByNewStatus:a,totalAppChanges:f.length,originalEvent:null==n?void 0:n[0],oldUrl:p,newUrl:m}};return e&&Object.assign(h.detail,e),h;function E(t,n){const e=c(t);n=n||rt(e),r[e]=n,(a[n]=a[n]||[]).push(e)}}function T(t,n){e||window.dispatchEvent(new CustomEvent(`single-spa:${t}`,n))}}function Tt(t,n){return a(t)?w(t).then((t=>n.then((()=>a(t)?T(t):t)))):n.then((()=>t))}let vt=!1;function yt(t){vt=!0,C&&(J(t),Nt())}function _t(){return vt}var gt={getRawAppData:function(){return[...nt]},reroute:Nt,NOT_LOADED:s.NOT_LOADED,toLoadPromise:K,toBootstrapPromise:w,unregisterApplication:at,getProfilerData:function(){return E}};C&&window.__SINGLE_SPA_DEVTOOLS__&&(window.__SINGLE_SPA_DEVTOOLS__.exposedMethods=gt);export{s as AppOrParcelStatus,e as addErrorHandler,ut as checkActivityFunctions,q as ensureJQuerySupport,ot as getAppNames,rt as getAppStatus,et as getMountedApps,_ as mountRootParcel,G as navigateToUrl,J as patchHistoryApi,mt as pathToActiveWhen,st as registerApplication,o as removeErrorHandler,U as setInitMaxTime,S as setMountMaxTime,R as setUnloadMaxTime,L as setUnmountMaxTime,yt as start,Ot as triggerAppChange,ct as unloadApplication,at as unregisterApplication};
//# sourceMappingURL=single-spa.min.js.map
